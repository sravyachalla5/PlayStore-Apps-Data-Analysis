create database Playstore;
use Playstore;
select * from apps_playstore;

create table Review_Playstore(
Serial_num int(100),
App text(50000),
Translated_Review LONGTEXT,
Sentiment varchar(500),
Sentiment_Polarity double(5,5),
Sentiment_Subjectivity double(5,5)
);
select * from Review_Playstore;
LOAD DATA LOCAL infile
'C:/Users/prana/Music/skillash_python/t_20_project/Play_store_project/playstoreliveproj Drive FIle/playstoreliveproj/Clean_reviews_df.csv'
INTO TABLE Review_Playstore
FIELDS TERMINATED BY ',';
#drop table review_playstore; 

create table Review_Playstore(
 id INT NOT NULL,
App VARCHAR(555) NOT NULL,
Translated_Review VARCHAR(1555) NOT NULL,
Sentiment VARCHAR(50) NOT NULL,
Sentiment_Polarity FLOAT(10),
Sentiment_Subjectivity FLOAT(10)
);

LOAD DATA LOCAL infile
'C:/Users/prana/Music/skillash_python/t_20_project/Play_store_project/playstoreliveproj Drive FIle/playstoreliveproj/Clean_reviews_df.csv'
INTO TABLE Review_Playstore
FIELDS TERMINATED BY ','
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS;
select * from Review_Playstore;

# 1. 1.	Which apps have the highest rating in the given available dataset?
select * from apps_playstore;
select App,Rating from apps_playstore
where Rating = 5;
select app, rating 
from apps_playstore
where rating= (select max(rating) from apps_playstore);


#2. What are the number of installs and reviews for the above apps? Return the apps with the highest reviews to the top.
select App,Reviews,Installs from apps_playstore
where Rating = 5
order by Reviews desc;

select app, installs, reviews
from apps_playstore
where rating= (select max(rating) from apps_playstore)
order by reviews desc;

#3.	Which app has the highest number of reviews? Also, mention the number of reviews and category of the app
select App, (Reviews) as total_num_reviews,Category from apps_playstore
order by reviews desc limit 1;
#4.	What is the total amount of revenue generated by the google play store by hosting apps? 
#   (Whenever a user buys apps  from the google play store, the amount is considered in the revenue)
select sum(Price) as Total_Amount 
from apps_playstore;

#5.	Which Category of google play store apps has the highest number of installs? also, 
#   find out the total number of installs for that particular category.
select Category, sum(Installs) as tot_installs from apps_playstore
group by Category
order by Installs  desc limit 1;
#6.Which Genre has the most number of published apps?
select Genres, count(App) from apps_playstore
group by Genres
order by count(App) desc limit 1;
#7.	Provide the list of all games ordered in such a way that the game that has the highest number of installs is displayed on the top
#  (to avoid duplicate results use distinct)
select distinct App, Installs from apps_playstore
where Category like 'GAME'
order by Installs desc;

#8.	Provide the list of apps that can work on android version 4.0.3 and UP.
select * from apps_playstore;

select app from apps_playstore
where `Android Ver` like '4.0.3 and UP';

#9.	How many apps from the given data set are free? Also, provide the number of paid apps.
select * from apps_playstore;
select count(app) as No_of_free_apps from apps_playstore
where Price = 0;
select count(app) as No_of_paid_apps from apps_playstore
where  Price > 0;

select sum(f.free_apps) as Total_no_of_free_apps from(
select  Distinct App, count(Price) as free_apps from apps_playstore where Price = 0
group by App)as f;

select sum(p.paid_apps) as Total_no_of_paid_apps from(
select  Distinct App, count(Price) as paid_apps from apps_playstore where Price != 0
group by App)as p;

select count(distinct app) from apps_playstore;


# 10.	Which is the best dating app? (Best dating app is the one having the highest number of Reviews)
select APP from apps_playstore 
where Category like 'DATING'
ORDER BY REVIEWS DESC LIMIT 1;

select App, max(tr.Total_reviews) as No_of_reviews , Category from(
select Distinct App, sum(Reviews) as Total_reviews , Category from apps_playstore where Category = 'DATING'
 group by App order by Reviews desc)as tr;

#11.Get the number of reviews having positive sentiment and number of reviews 
# having negative sentiment for the app 10 best foods for you and compare them.

SELECT count(*) as no_of_reviews FROM REVIEW_PLAYSTORE
WHERE APP like '10 best foods for you' 
and SENTIMENT = 'Positive';
SELECT count(*) as no_of_reviews FROM REVIEW_PLAYSTORE
WHERE APP like '10 best foods for you' 
and SENTIMENT = 'Negative';
SELECT count(*) as no_of_reviews FROM REVIEW_PLAYSTORE
WHERE APP like '10 best foods for you' 
and SENTIMENT = 'Neutral';

SELECT count(*) as no_of_reviews FROM REVIEW_PLAYSTORE
WHERE APP like '10 best foods for you' ;

select App, count(*) as No_of_positive_reviews from REVIEW_PLAYSTORE where Sentiment = 'Positive' and App = '10 Best Foods for You';
select distinct sentiment from REVIEW_PLAYSTORE;


#12.Which comments of ASUS SuperNote have sentiment polarity and sentiment subjectivity both as 1?
select * FROM REVIEW_PLAYSTORE
where app = 'ASUS SuperNote' and sentiment_polarity = 1 and sentiment_subjectivity = 1;

#13	Get all the neutral sentiment reviews for the app Abs Training-Burn belly fat.
SELECT * FROM REVIEW_PLAYSTORE;
select Translated_review as review from review_playstore
where app like 'Abs Training-Burn belly fat' and sentiment like 'Neutral';

#14.Extract all negative sentiment reviews for Adobe Acrobat Reader with their sentiment polarity and sentiment subjectivity
select Translated_review as review, sentiment_polarity,  sentiment_subjectivity from review_playstore
where app like 'Adobe Acrobat Reader' and sentiment like 'Negative';
